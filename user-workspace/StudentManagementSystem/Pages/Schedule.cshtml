@page
@model StudentManagementSystem.Pages.ScheduleModel
@{
    ViewData["Title"] = "Class Schedule";
    var daysOfWeek = new[] { "Monday", "Tuesday", "Wednesday", "Thursday", "Friday" };
}

<div class="container mt-4">
    <h2 class="mb-4">Class Schedule</h2>

    <div class="card">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Weekly Schedule</h5>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Time</th>
                            @foreach (var day in daysOfWeek)
                            {
                                <th>@day</th>
                            }
                        </tr>
                    </thead>
                    <tbody>
                        @for (int hour = 8; hour < 20; hour++)
                        {
                            <tr>
                                <td class="text-nowrap">@($"{hour:D2}:00 - {hour+1:D2}:00")</td>
                                @foreach (var day in daysOfWeek)
                                {
                                    <td>
                                        @{
                                            var classesAtTime = Model.ScheduledClasses
                                                .Where(sc => sc.DayOfWeek.ToString() == day &&
                                                           sc.StartTime.Hours <= hour &&
                                                           sc.EndTime.Hours > hour)
                                                .ToList();
                                        }
                                        @foreach (var scheduledClass in classesAtTime)
                                        {
                                            <div class="class-block bg-primary text-white p-2 rounded">
                                                <strong>@scheduledClass.Course?.CourseName</strong><br />
                                                <small>@scheduledClass.StartTime.ToString("HH:mm") - @scheduledClass.EndTime.ToString("HH:mm")</small>
                                            </div>
                                        }
                                    </td>
                                }
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Today's Classes -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Today's Classes</h5>
                </div>
                <div class="card-body">
                    @if (Model.TodaysClasses.Any())
                    {
                        <div class="list-group">
                            @foreach (var scheduledClass in Model.TodaysClasses.OrderBy(sc => sc.StartTime))
                            {
                                <div class="list-group-item">
                                    <h6 class="mb-1">@scheduledClass.Course?.CourseName</h6>
                                    <p class="mb-1">
                                        <i class="fas fa-clock me-2"></i>
                                        @scheduledClass.StartTime.ToString("HH:mm") - @scheduledClass.EndTime.ToString("HH:mm")
                                    </p>
                                </div>
                            }
                        </div>
                    }
                    else
                    {
                        <p class="text-center py-3">No classes scheduled for today.</p>
                    }
                </div>
            </div>
        </div>

        <!-- Upcoming Classes -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Upcoming Classes</h5>
                </div>
                <div class="card-body">
                    @if (Model.UpcomingClasses.Any())
                    {
                        <div class="list-group">
                            @foreach (var scheduledClass in Model.UpcomingClasses)
                            {
                                <div class="list-group-item">
                                    <h6 class="mb-1">@scheduledClass.Course?.CourseName</h6>
                                    <p class="mb-1">
                                        <i class="fas fa-calendar me-2"></i>
                                        @scheduledClass.DayOfWeek
                                        <i class="fas fa-clock ms-3 me-2"></i>
                                        @scheduledClass.StartTime.ToString("HH:mm") - @scheduledClass.EndTime.ToString("HH:mm")
                                    </p>
                                </div>
                            }
                        </div>
                    }
                    else
                    {
                        <p class="text-center py-3">No upcoming classes scheduled.</p>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .class-block {
        margin: -0.5rem;
        font-size: 0.875rem;
    }
</style>